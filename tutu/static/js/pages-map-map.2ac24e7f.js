(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-map-map"],{"0481":function(t,a,e){"use strict";var n=e("23e7"),i=e("a2bf"),o=e("7b0b"),l=e("07fa"),s=e("5926"),r=e("65f0");n({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,a=o(this),e=l(a),n=r(a,0);return n.length=i(n,a,a,e,0,void 0===t?1:s(t)),n}})},"0c73":function(t,a,e){"use strict";(function(t){e("7a82");var n=e("dbce").default,i=e("4ea4").default;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=i(e("5530")),l=i(e("c7eb")),s=i(e("1da1")),r=i(e("ade3")),u=i(e("b85c"));e("d81d"),e("ac1f"),e("466d"),e("d3b7"),e("3ca3"),e("ddb0"),e("fb6a"),e("99af"),e("0481"),e("4069"),e("a9e3"),e("14d9"),e("b64b"),e("a4d3"),e("e01a");var c=i(e("2299")),d=i(e("ced1")),f=n(e("2ef0")),p=(e("8f24"),i(e("c9c7"))),h=new p.default({key:"3X4BZ-XLHWQ-LOW5Q-BBRJ6-IYFLH-U2FR6"}),v={name:"ai-route",data:function(){return{aiPlanName:(new Date).getMonth()+1+"月"+(new Date).getDate()+"日新路线",updatePlanName:!1,planPoi:[],desc:"",stopStatus:!1,intoCard:"",timer:null,startMoveY:0,cardHeight:"25%",hours:0,plan1Data:[],planTime:0,planTimeStatus:!1,polyline:[],customCalloutMarkerIds:[],markers:[]}},props:{showModal:{type:Boolean,default:!1},tagList:{type:Array,default:function(){return[]}},myPlanInfo:{type:String,default:""}},mounted:function(a){t.log("mounted==",a),this.startPolling()},watch:{showModal:function(a,e){t.log("监听--showModal",a),a||(t.log("监听到了"),this.stopScoket(),t.log("还是监听到了"))},stopStatus:function(a,e){if(a&&this.polyline.length>0){var n=f.uniqBy(this.plan1Data,"from.name");this.plan1Data=n,t.log("进入到路线判断---之前",this.polyline),this.polyline.length===this.plan1Data.length-1&&(t.log("进入到路线判断",this.polyline),this.makePlanRoutePoi(this.customCalloutMarkerIds,this.markers,this.polyline)),t.log("进入到路线判断---之后",this.polyline)}}},methods:{arrToStr:function(){var t="";return this.tagList&&this.tagList.map((function(a,e){t+=0===e?a.name:"、".concat(a.name)})),t},upTouchStart:function(a){t.log(a),this.startMoveY=a.touches[0].pageY},upTouchMove:function(t){this.startMoveY-t.touches[0].pageY>25&&(this.cardHeight="78%"),t.touches[0].pageY-this.startMoveY>50&&(this.cardHeight="25%")},up:function(){t.log(123123),this.cardHeight="78%"},estimatePixelLength:function(t){var a,e=0,n=(0,u.default)(t);try{for(n.s();!(a=n.n()).done;){var i=a.value;i.match(/[\x00-\xff]/)?e+=6:(i.match(/[\u4e00-\u9fa5]/),e+=12)}}catch(o){n.e(o)}finally{n.f()}return e/2+10},makePlanRoute:function(){var a=this;this.cardHeight="25%",this.markers=this.planPoi.map((function(t,e){var n;return n={poi_id:2===d.default.state.command?t.id:e,latitude:t.position.lat,longitude:t.position.long,label:{content:t.name,fontSize:12,bgColor:"#ffffff",color:"#000",padding:9,textAlgin:"center",borderWidth:1,borderColor:"#000",borderRadius:14,anchorX:-a.estimatePixelLength(t.name),anchorY:-85},width:40,height:47,poi_type:t.type,isActive:!0,isSelect:!0,item_id:2===d.default.state.command?t.id:e,alpha:1,joinCluster:!1},(0,r.default)(n,"alpha",1),(0,r.default)(n,"zIndex",10),(0,r.default)(n,"customCallout",{anchorY:10,anchorX:0,display:"ALWAYS"}),n})),t.log("显示路线aiaiaiai",this.markers),this.$emit("changeMapPoi",this.markers),this.makeRoute()},outputItemsWithDelay:function(){var t=this;return(0,s.default)((0,l.default)().mark((function a(){var e,n;return(0,l.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Promise.all(t.planPoi.slice(0,-1).map((function(a,e){return new Promise((function(a){setTimeout((0,s.default)((0,l.default)().mark((function n(){return(0,l.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.planRouteSDK(t.planPoi,e,!1);case 2:a();case 3:case"end":return n.stop()}}),n)}))),1200*(e+1))}))})));case 2:for(e=function(a){t.planPoi[a].distance>1e3?t.planPoi[a]["modeType"]="transit":t.planPoi[a]["modeType"]="walking",setTimeout((0,s.default)((0,l.default)().mark((function e(){return(0,l.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.planRouteSDK(t.planPoi,a,!0);case 2:case"end":return e.stop()}}),e)}))),1200*(a+1))},n=0;n<t.planPoi.length-1;n++)e(n);case 4:case"end":return a.stop()}}),a)})))()},makeRoute:function(){var a=this;return(0,s.default)((0,l.default)().mark((function e(){var n;return(0,l.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.log("开始计算距离",a.planPoi),uni.showToast({icon:"loading",title:"正在生成路线",duration:1500*a.planPoi.length}),a.plan1Data=[],a.polyline=[],a.planTime=0,e.next=7,a.outputItemsWithDelay();case 7:1===d.default.state.command&&(t.log("循环之前的planPoi：",a.planPoi),t.log("循环之前的plan1data：",a.plan1Data),a.planPoi.map((function(e,n){a.plan1Data.map((function(i,o){i.from.id===e.poi_id&&(t.log(e,i),a.planPoi[n]=i.from)}))})),t.log("循环后的planPoi：",a.planPoi)),2===d.default.state.command&&(a.planPoi.map((function(t,e){a.plan1Data.map((function(n,i){n.from.name===t.name&&(a.planPoi[e]=n.from)}))})),n=f.uniqBy(a.plan1Data,"from.name"),a.plan1Data=n);case 9:case"end":return e.stop()}}),e)})))()},planRouteSDK:function(a,e,n){var i=this;return new Promise((function(l,s){h.direction({mode:a[e].modeType||"walking",from:{longitude:a[e].position.long,latitude:a[e].position.lat},to:{longitude:a[e+1].position.long,latitude:a[e+1].position.lat},sig:"K8tBdzEsidiSPzS9VgLld0Z7otmc0yvR",success:function(s){t.log(e,"计算距离=success",s);var r=s;if(i.plan1Data[e]=(0,o.default)((0,o.default)({},r.result.routes[0]),{},{from:(0,o.default)((0,o.default)({},r.result.routes[0]),a[e]),to:(0,o.default)({},a[e+1])}),t.log("sdk success中，存放最后一个地点之前的plan1Data",i.plan1Data),t.log(e,a.length,a.length-2),t.log("最后一个赋值后",i.plan1Data),n){var u=[];if(r.result.routes[0].polyline)u=u.concat(r.result.routes[0].polyline);else for(var c=0;c<r.result.routes[0].steps.length;c++)u="TRANSIT"===r.result.routes[0].steps[c].mode?u.concat(r.result.routes[0].steps[c].lines.map((function(t){return t.polyline}))).flat():u.concat(r.result.routes[0].steps[c].polyline);for(var d=[],f=2;f<u.length;f++)u[f]=Number(u[f-2])+Number(u[f])/1e6;for(var p=0;p<u.length;p+=2)d.push({latitude:u[p],longitude:u[p+1]});t.log("ret.result.routes[0].duration",r.result.routes[0].duration);var h=Number(r.result.routes[0].duration?r.result.routes[0].duration:0);t.log("ret.result.routes[0].duration---",h),i.planTime+=h,t.log("总时间",i.planTime),t.log("---===---",i.polyline),i.polyline.push({points:d,color:"#4385C1F0",dottedLine:!1,arrowLine:!0,borderColor:"#185FA1",borderWidth:3,width:12,clickable:!0}),i.polyline.length===a.length-1&&(emit("makePlanRoutePoi",{polyline:polyline}),planTimeStatus.value=!0),t.log("路线",i.polyline),l(d)}else l(s)},fail:function(a){t.log("计算距离失败",a),s(a)}})}))},stopPolling:function(){var a=this;return(0,s.default)((0,l.default)().mark((function e(){return(0,l.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return clearInterval(a.timer),a.timer=null,a.stopStatus=!0,e.next=5,d.default.dispatch("clearSocket");case 5:t.log("socket停止轮询",a.planPoi),a.planPoi=a.planPoi.map((function(a,e){return t.log(e,a),(0,o.default)((0,o.default)({},a),{},{id:1===d.default.state.command?a.id:e,poi_id:1===d.default.state.command?a.id:e,position:{lat:a.latitude,long:a.longitude,x:a.x,y:a.y},isActive:!0})})),c.default.state.usersPoiList=a.planPoi,a.makePlanRoute();case 9:case"end":return e.stop()}}),e)})))()},consoleSocket:function(){t.log("取值=======",d.default.state.socketObj),0!==Object.keys(d.default.state.socketObj).length&&(t.log("页面中请求数据socketRes: ",d.default.state.socketRes),t.log("页面中请求数据socketPoi: ",d.default.state.socketPoi),t.log("页面中请求数据socketStatus: ",d.default.state.socketStatus),t.log("页面中请求数据socketObj: ",d.default.state.socketObj),this.desc=d.default.state.socketRes,this.planPoi=d.default.state.socketPoi,this.$forceUpdate(),this.hours=d.default.state.hours,d.default.state.socketStatus&&(this.stopStatus=d.default.state.socketStatus,this.stopPolling()))},startPolling:function(){this.timer||(this.timer=setInterval(this.consoleSocket,100),this.stopStatus=!1,t.log("socket轮询"))},getSocket:function(){this.startPolling()},stopScoket:function(){var a=arguments,e=this;return(0,s.default)((0,l.default)().mark((function n(){var i;return(0,l.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=!(a.length>0&&void 0!==a[0])||a[0],t.log("stop--",(new Date).getTime()),e.stopPolling(),null===d.default.state.socketTask){n.next=9;break}return n.next=6,d.default.dispatch("closeSocket");case 6:if(i){n.next=8;break}return n.abrupt("return");case 8:e.stopPolling();case 9:case"end":return n.stop()}}),n)})))()},rePlan:function(){var t=this;return(0,s.default)((0,l.default)().mark((function a(){return(0,l.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.clearPlanData(),a.next=3,t.stopScoket();case 3:emit("rePlan"),t.startPolling();case 5:case"end":return a.stop()}}),a)})))()},reFind:function(){var t=this;return(0,s.default)((0,l.default)().mark((function a(){return(0,l.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.clearPlanData(),a.next=3,t.stopScoket();case 3:emit("reFind");case 4:case"end":return a.stop()}}),a)})))()},savePlan:function(){var a=this;return(0,s.default)((0,l.default)().mark((function e(){var n,i,s,u,d,f,p,h;return(0,l.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.log("保存路线事件",a.planPoi),uni.showToast({title:"正在保存路线",icon:"loading",mask:!0,duration:1e5}),n=a.planPoi.map((function(t){return(0,o.default)((0,o.default)({},t),{},{address:t.address,desc:t.description?t.description:t.desc,img_url:t.image_url?t.image_url:t.img_url,poi_type:t.type_id?t.type_id:t.poi_type})})),e.next=5,c.default.dispatch("postCreateOrUpdatePoiInPost",{pois:n,postId:0});case 5:return i=e.sent,t.log("resAddPois",i),s=i.pois.map((function(t){return t.id})),e.next=10,c.default.dispatch("postAddPois",{poi_ids:s,collection_ids:[]});case 10:return u=0,a.planPoi.map((function(t){return t.distance?u+=t.distance:0})),d=0,a.planPoi.map((function(t){return t.duration?d+=t.duration:0})),f=a.planPoi.map((function(t,e){return{from_poi:t.from,to_poi:t.to,way:e<a.planPoi.length?t.mode?t.mode:t.duration_1m?"bus":"":""}})),t.log("this.planPoi:",a.planPoi),t.log("plan1Data:",a.plan1Data),t.log("plan_travel_modes",f),p=i.pois.map((function(t,e){var n=a.planPoi[e]["way"];return(0,o.default)((0,o.default)({},t),{},(0,r.default)({},"way",n))})),h={name:aiPlanName.value,poi_list:p,travel_dist:u,travel_modes:f,travel_time:d},e.next=22,c.default.dispatch("postUserAddTrip",h);case 22:emit("saveLine"),setTimeout((function(){uni.hideToast()}),1500);case 24:case"end":return e.stop()}}),e)})))()},changePlanName:function(){t.log(123123),this.updatePlanName=!0},blurFocus:function(){this.updatePlanName=!1},clearPlanData:function(){this.desc="",this.planPoi=[],this.intoCard="",this.stopStatus=!1,this.plan1Data=ref([]),this.planTime=ref(0),this.polyline=ref([]),this.customCalloutMarkerIds=ref([]),this.markers=ref([]),d.default.dispatch("clearSocket")}}};a.default=v}).call(this,e("5a52")["default"])},"19ba":function(t,a,e){var n=e("70a0");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=e("4f06").default;i("7eaf0b34",n,!0,{sourceMap:!1,shadowMode:!1})},"218b":function(t,a,e){"use strict";e.r(a);var n=e("8bba"),i=e.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){e.d(a,t,(function(){return n[t]}))}(o);a["default"]=i.a},"28b5":function(t,a,e){"use strict";e.r(a);var n=e("966b"),i=e("9fc5");for(var o in i)["default"].indexOf(o)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(o);e("3a37");var l=e("f0c5"),s=Object(l["a"])(i["default"],n["b"],n["c"],!1,null,"1eb09c8c",null,!1,n["a"],void 0);a["default"]=s.exports},"29e0":function(t,a,e){"use strict";e.d(a,"b",(function(){return n})),e.d(a,"c",(function(){return i})),e.d(a,"a",(function(){}));var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.drag?e("v-uni-view",{ref:"floating",staticClass:"floatingComponent",on:{touchstart:function(a){arguments[0]=a=t.$handleEvent(a),t.onStart.apply(void 0,arguments)},touchmove:function(a){arguments[0]=a=t.$handleEvent(a),t.onMove.apply(void 0,arguments)},touchend:function(a){arguments[0]=a=t.$handleEvent(a),t.onEnd.apply(void 0,arguments)}}},[t._t("default")],2):e("v-uni-view",{ref:"floating",staticClass:"floatingComponent"},[t._t("default")],2)},i=[]},"3a37":function(t,a,e){"use strict";var n=e("19ba"),i=e.n(n);i.a},4069:function(t,a,e){var n=e("44d2");n("flat")},6068:function(t,a,e){"use strict";e.d(a,"b",(function(){return i})),e.d(a,"c",(function(){return o})),e.d(a,"a",(function(){return n}));var n={tnInput:e("e0b8").default},i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.showModal?e("v-uni-view",{staticClass:"ai_bg",style:{height:t.cardHeight}},[e("v-uni-view",{staticStyle:{margin:"0 30rpx","margin-top":"-84rpx",height:"100%"}},[e("v-uni-view",{staticClass:"top_card_bg",on:{touchstart:function(a){arguments[0]=a=t.$handleEvent(a),t.upTouchStart.apply(void 0,arguments)},touchmove:function(a){arguments[0]=a=t.$handleEvent(a),t.upTouchMove.apply(void 0,arguments)}}},[e("v-uni-image",{staticClass:"top-bg",attrs:{src:"/static/ai-plan-top-bg.svg",mode:""}}),e("v-uni-view",{staticClass:"card_touch"},["25%"===t.cardHeight?e("v-uni-image",{staticClass:"up",attrs:{src:"/static/up.svg",mode:""},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.up.apply(void 0,arguments)}}}):e("v-uni-image",{staticClass:"pack_up",attrs:{src:"/static/pack-up.png",mode:""}})],1),e("v-uni-view",{staticClass:"card_name"},[e("tn-input",{staticClass:"input",attrs:{focus:t.updatePlanName,border:!1,"cursor-spacing":50,"max-length":20},on:{blur:function(a){arguments[0]=a=t.$handleEvent(a),t.blurFocus.apply(void 0,arguments)}},scopedSlots:t._u([{key:"suffix",fn:function(){return[e("v-uni-text",{staticClass:"tn-icon-edit"})]},proxy:!0}],null,!1,3686549165),model:{value:t.aiPlanName,callback:function(a){t.aiPlanName=a},expression:"aiPlanName"}})],1),e("v-uni-view",{staticClass:"ai_tutu_title"},[t.stopStatus&&t.planTimeStatus&&0===t.hours?e("v-uni-view",{staticClass:"ai_plan_time"},[t._v("路线全长约\n\t\t\t\t\t"+t._s(t.publishedBooksMessage(t.planTime)))]):t._e(),t.stopStatus&&t.planTimeStatus&&t.hours>0?e("v-uni-view",{staticClass:"ai_plan_time"},[t._v("路线全长约 "+t._s(t.hours)+" 小时")]):t._e(),t.stopStatus&&t.planTimeStatus?t._e():e("v-uni-view",{staticClass:"ai_plan_time planing"},[e("v-uni-label",{staticClass:"label_txt"},[t._v("正")]),e("v-uni-label",{staticClass:"label_txt"},[t._v("在")]),e("v-uni-label",{staticClass:"label_txt"},[t._v("规")]),e("v-uni-label",{staticClass:"label_txt"},[t._v("划")]),e("v-uni-label",{staticClass:"label_txt"},[t._v("中")]),e("v-uni-label",{staticClass:"label_txt"},[t._v("·")]),e("v-uni-label",{staticClass:"label_txt"},[t._v("·")]),e("v-uni-label",{staticClass:"label_txt"},[t._v("·")])],1),t.stopStatus?e("v-uni-view",{staticClass:"time"},[t._v("包含 "+t._s(t.planPoi.length)+" 个点")]):t._e()],1)],1),e("v-uni-scroll-view",{staticClass:"scroll_card",attrs:{"scroll-y":!0,"show-scrollbar":!1,"enable-flex":!0,"scroll-into-view":t.intoCard}},[e("v-uni-view",{staticClass:"scroll_card_item",staticStyle:{padding:"36rpx"}},[e("v-uni-view",{staticClass:"scroll_card_info"},[t.myPlanInfo?e("v-uni-view",{staticClass:"info"},[t._v("“"+t._s(t.myPlanInfo)+"”")]):t._e(),e("v-uni-view",{staticClass:"info"},[t._v(t._s(t.arrToStr()))])],1),e("v-uni-view",{staticClass:"all_result"},[t._v(t._s(t.desc))])],1),t._l(t.planPoi,(function(a,n){return e("v-uni-view",{key:a.latitude,attrs:{id:"intoCard"+n}},[e("v-uni-view",{staticClass:"scroll_card_item"},[0===n||t.planPoi.length>1&&n===t.planPoi.length-1&&t.stopStatus?e("v-uni-view",{staticClass:"ai_card_title"},[t._v(t._s(0===n?"起点":"终点")+" "+t._s(a.name))]):e("v-uni-view",{staticClass:"ai_card_title"},[t._v(t._s(a.name))]),e("v-uni-view",{staticClass:"ai_card_desc"},[t._v(t._s(a.poi_desc))]),a.poi_status?e("v-uni-view",{staticClass:"card_local"},[e("v-uni-text",{staticClass:"tn-icon-money"}),a.cost>0?e("v-uni-view",[t._v("￥ "+t._s(a.cost)+"/人")]):e("v-uni-view",[t._v("免费")])],1):t._e(),a.poi_status?e("v-uni-view",{staticClass:"card_local"},[e("v-uni-text",{staticClass:"tn-icon-time"}),a.open_hours?e("v-uni-view",[t._v(t._s(a.open_hours))]):e("v-uni-view",[t._v("全天")])],1):t._e(),a.poi_status?e("v-uni-view",{staticClass:"card_local"},[e("v-uni-text",{staticClass:"tn-icon-location"}),e("v-uni-view",[t._v(t._s(a.address))])],1):t._e(),a.poi_status?e("v-uni-view",{staticClass:"card_img"},[e("v-uni-image",{attrs:{src:a.image_url,mode:"aspectFill"}})],1):t._e()],1),n<t.planPoi.length-1&&a.distance?e("v-uni-view",{staticClass:"dis"},[t._v("相距 "+t._s(t.meters(a.distance)))]):t._e(),n<t.planPoi.length-1&&!a.distance?e("v-uni-view",{staticClass:"dis"},[t._v("距离正在计算中 ···")]):t._e()],1)}))],2),t.stopStatus?t._e():e("v-uni-view",{staticClass:"bottom_btn"},[e("v-uni-view",{staticClass:"bottom_btn_rePlan",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.rePlan.apply(void 0,arguments)}}},[t._v("重新生成路线")]),e("v-uni-view",{staticClass:"bottom_btn_reFind",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.reFind.apply(void 0,arguments)}}},[t._v("重新找灵感")])],1),t.stopStatus?e("v-uni-view",{staticClass:"bottom_btn"},[e("v-uni-view",{staticClass:"bottom_btn_savePlan",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.savePlan.apply(void 0,arguments)}}},[t._v("保存路线")])],1):t._e()],1),t.stopStatus?t._e():e("v-uni-view",{staticClass:"stop_btn",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.stopScoket(!1)}}},[t._v("停止生成···")])],1):t._e()},o=[]},6528:function(t,a,e){"use strict";e.r(a);var n=e("0c73"),i=e.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){e.d(a,t,(function(){return n[t]}))}(o);a["default"]=i.a},"70a0":function(t,a,e){var n=e("24fb");a=n(!1),a.push([t.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.map[data-v-1eb09c8c]{width:100vw;height:100vh;z-index:1}.map .route[data-v-1eb09c8c]{z-index:2}',""]),t.exports=a},"7a7b":function(t,a,e){var n=e("24fb");a=n(!1),a.push([t.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.ai_bg[data-v-80f07a26]{position:fixed;bottom:0;left:0;height:68%;width:%?750?%;background:linear-gradient(180deg,rgba(253,253,254,0),#fdfdfe 7.47%);z-index:10;padding-bottom:calc(%?78?% + var(--window-bottom))}.top_card_bg[data-v-80f07a26]{position:relative}.top_card_bg .top-bg[data-v-80f07a26]{width:%?690?%;height:%?160?%;box-shadow:0 0 %?80?% rgba(41,44,53,.15);border-radius:%?36?%}.top_card_bg .top-bg-msg[data-v-80f07a26]{width:%?650?%;height:%?226?%;position:absolute;left:%?20?%;top:%?362?%}.top_card_bg .card_touch[data-v-80f07a26]{position:absolute;top:%?-40?%;left:%?305?%;-webkit-animation:light-data-v-80f07a26 1.6s linear infinite;animation:light-data-v-80f07a26 1.6s linear infinite}.top_card_bg .card_touch .up[data-v-80f07a26]{width:%?80?%;height:%?14?%}.top_card_bg .card_touch .pack_up[data-v-80f07a26]{width:%?80?%;height:%?6?%}@-webkit-keyframes light-data-v-80f07a26{0%{opacity:1}25%{opacity:.6}50%{opacity:.2}75%{opacity:.6}100%{opacity:1}}@keyframes light-data-v-80f07a26{0%{opacity:1}25%{opacity:.6}50%{opacity:.2}75%{opacity:.6}100%{opacity:1}}.top_card_bg .card_name[data-v-80f07a26]{position:absolute;top:%?16?%;left:calc(50% - %?138?%);display:flex;align-items:center;justify-content:center;color:#656566;text-align:right;font-family:PingFang SC;font-size:%?28?%;font-style:normal;font-weight:400;line-height:normal}.top_card_bg .card_name .input[data-v-80f07a26]{width:%?256?%;text-align:center}.top_card_bg .ai_tutu_title[data-v-80f07a26]{position:absolute;left:%?48?%;top:%?88?%;display:flex;align-items:center}.top_card_bg .ai_tutu_title .time[data-v-80f07a26]{color:#292c35;font-size:%?20?%;border-radius:%?40?%;background:rgba(82,85,92,.1);padding:0 %?18?%;margin-left:%?10?%}.top_card_bg .ai_tutu_title .ai_plan_time[data-v-80f07a26]{color:#292c35;font-family:PingFang SC;font-size:%?32?%;font-style:normal;font-weight:600;line-height:%?44?%}.top_card_bg .ai_tutu_title .planing .label_txt[data-v-80f07a26]{color:#292c35}.top_card_bg .ai_tutu_title .planing .label_txt[data-v-80f07a26]:nth-child(1){-webkit-animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out;animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out}.top_card_bg .ai_tutu_title .planing .label_txt[data-v-80f07a26]:nth-child(2){-webkit-animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out;animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out;-webkit-animation-delay:.2s;animation-delay:.2s}.top_card_bg .ai_tutu_title .planing .label_txt[data-v-80f07a26]:nth-child(3){-webkit-animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out;animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out;-webkit-animation-delay:.4s;animation-delay:.4s}.top_card_bg .ai_tutu_title .planing .label_txt[data-v-80f07a26]:nth-child(4){-webkit-animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out;animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out;-webkit-animation-delay:.6s;animation-delay:.6s}.top_card_bg .ai_tutu_title .planing .label_txt[data-v-80f07a26]:nth-child(5){-webkit-animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out;animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out;-webkit-animation-delay:.8s;animation-delay:.8s}.top_card_bg .ai_tutu_title .planing .label_txt[data-v-80f07a26]:nth-child(6){-webkit-animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out;animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out;-webkit-animation-delay:1;animation-delay:1}.top_card_bg .ai_tutu_title .planing .label_txt[data-v-80f07a26]:nth-child(7){-webkit-animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out;animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out;-webkit-animation-delay:1.2s;animation-delay:1.2s}.top_card_bg .ai_tutu_title .planing .label_txt[data-v-80f07a26]:nth-child(8){-webkit-animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out;animation:dotBlink-data-v-80f07a26 1.4s infinite ease-in-out;-webkit-animation-delay:1.4s;animation-delay:1.4s}@-webkit-keyframes dotBlink-data-v-80f07a26{0%{opacity:.5;-webkit-transform:scale(1);transform:scale(1)}20%{opacity:.7;-webkit-transform:scale(1.8);transform:scale(1.8)}50%{opacity:1;-webkit-transform:scale(2);transform:scale(2)}80%{opacity:.7;-webkit-transform:scale(1.8);transform:scale(1.8)}100%{opacity:.5;-webkit-transform:scale(1);transform:scale(1)}}@keyframes dotBlink-data-v-80f07a26{0%{opacity:.5;-webkit-transform:scale(1);transform:scale(1)}20%{opacity:.7;-webkit-transform:scale(1.8);transform:scale(1.8)}50%{opacity:1;-webkit-transform:scale(2);transform:scale(2)}80%{opacity:.7;-webkit-transform:scale(1.8);transform:scale(1.8)}100%{opacity:.5;-webkit-transform:scale(1);transform:scale(1)}}.scroll_card[data-v-80f07a26]{height:100%;padding:0 0 %?200?% 0}.scroll_card .dis[data-v-80f07a26]{color:#292c35;text-align:center;font-family:PingFang SC;font-size:12px;font-style:normal;font-weight:400;line-height:normal;text-align:center}.scroll_card .scroll_card_item[data-v-80f07a26]{width:%?560?%;border-radius:10px;background:#fff;padding:%?40?% %?50?%;margin:20px %?60?%;box-shadow:0 0 40px rgba(41,44,53,.15)}.bottom_btn[data-v-80f07a26]{position:fixed;left:0;bottom:0;height:%?200?%;width:%?750?%;background:#fff;display:flex;align-items:center;justify-content:space-evenly}.bottom_btn .bottom_btn_rePlan[data-v-80f07a26],\n.bottom_btn .bottom_btn_reFind[data-v-80f07a26],\n.bottom_btn .bottom_btn_savePlan[data-v-80f07a26]{width:127px;height:44px;border-radius:26px;background:#f8d562;display:flex;align-items:center;justify-content:center}.bottom_btn .bottom_btn_savePlan[data-v-80f07a26]{width:%?520?%;height:%?88?%;border-radius:%?52?%;background:#f8d562}.ai_card_title[data-v-80f07a26]{color:#292c35;text-align:left;font-family:PingFang SC;font-size:%?32?%;font-style:normal;font-weight:600;line-height:normal}.ai_card_desc[data-v-80f07a26]{color:rgba(41,44,53,.6);font-family:PingFang SC;font-size:%?24?%;font-style:normal;font-weight:400;line-height:normal;margin-top:%?8?%}.card_local[data-v-80f07a26]{color:#292c35;font-family:PingFang SC;font-size:%?24?%;font-style:normal;font-weight:400;line-height:normal;letter-spacing:.311px;margin:%?10?% 0 0;display:flex;justify-content:flex-start}.card_local uni-view[data-v-80f07a26]{padding-left:%?12?%}.card_img[data-v-80f07a26]{width:100%;height:%?260?%;border-radius:%?20?%;background:#fff;margin-top:%?14?%}.card_img uni-image[data-v-80f07a26]{width:100%;height:100%}.scroll_card_info[data-v-80f07a26]{color:#292c35;text-align:justify;font-family:PingFang SC;font-size:12px;font-style:normal;font-weight:400;line-height:normal;padding:%?22?%;background-color:#faf8f5;position:relative}.scroll_card_info[data-v-80f07a26]::before{content:"";position:absolute;bottom:%?-16?%;left:%?20?%;width:0;height:0;border-left:%?16?% solid transparent;border-right:%?16?% solid transparent;border-top:%?16?% solid #faf8f5;border-radius:%?8?% 0 0 0}.all_result[data-v-80f07a26]{color:#292c35;font-family:PingFang SC;font-size:14px;font-style:normal;font-weight:500;line-height:25px;\n  /* 178.571% */margin-top:%?28?%}.stop_btn[data-v-80f07a26]{width:%?208?%;height:%?68?%;box-shadow:0 0 %?80?% rgba(41,44,53,.15);border-radius:%?70?%;background:#fff;display:flex;align-items:center;justify-content:center;color:#292c35;text-align:center;font-family:PingFang SC;font-size:%?28?%;font-style:normal;font-weight:400;line-height:normal;position:fixed;bottom:120px;left:%?271?%;z-index:12}',""]),t.exports=a},"7a7d":function(t,a,e){"use strict";(function(t){e("7a82");var n=e("4ea4").default;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,e("d81d"),e("4de4"),e("d3b7");var i=n(e("5530")),o=n(e("c7eb")),l=n(e("1da1")),s=n(e("de5a")),r=n(e("dc2f")),u=n(e("ced1")),c={components:{move:s.default,aiRoute:r.default},data:function(){return{mapCtx:null,latitude:31.24166,longitude:121.48612,polyline:[],myScale:13,markers:[],userTalk:"",showModal:!0}},onLoad:function(a){this.mapCtx=uni.createMapContext("mapId",this),t.log("onload",a),this.latitude=a.userLat||0,this.longitude=a.userLang||0,this.myPlanInfo=a.userTalk||"";var e=getCurrentPages(),n=e[e.length-1];t.log("page",n),this.getLocaltion();var i=1===a.type?{ideaStr:this.myPlanInfo,type:a.type}:{ideaStr:this.myPlanInfo,type:a.type,walkTime:a.walkTime};u.default.dispatch("openSocket",i)},onUnload:function(){return(0,l.default)((0,o.default)().mark((function t(){return(0,o.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u.default.dispatch("closeSocket");case 2:case"end":return t.stop()}}),t)})))()},methods:{getLocaltion:function(){var a=this;uni.getLocation({type:"gcj02",complete:function(e){t.log("getLocaltion",e),a.latitude=e.latitude,a.longitude=e.longitude,a.userLat=e.latitude,a.userLang=e.longitude,setTimeout((function(){a.mapCtx.moveToLocation({latitude:e.latitude,longitude:e.longitudea,success:function(a){t.log("move")}})}),0)}})},changeMapPoi:function(a){t.log(a),this.markers=a.filter((function(t){return t.isActive})).map((function(t){return(0,i.default)((0,i.default)({},t),{},{iconPath:"/static/icon/eat.png"})})),this.$forceUpdate(),t.log(this.markers),this.mapCtx.moveToLocation({latitude:this.markers[0].latitude,longitude:this.markers[0].longitudea,success:function(a){t.log("move")}})}}};a.default=c}).call(this,e("5a52")["default"])},"8bba":function(t,a,e){"use strict";(function(t){e("7a82"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n={name:"move",props:{drag:{type:Boolean,default:!1}},data:function(){return{fLeft:0,fTop:0,left:0,top:0}},methods:{init:function(){t.log("floating",this.$refs.floating)},onStart:function(t){this.fLeft=t.touches[0].clientX-this.$refs.floating.$el.offsetLeft,this.fTop=t.touches[0].clientY-this.$refs.floating.$el.offsetTop},onMove:function(a){t.log(a);var e=window.innerWidth,n=window.innerHeight,i=a.touches[0].clientX-this.fLeft,o=a.touches[0].clientY-this.fTop,l=this.$refs.floating.$el.offsetWidth,s=this.$refs.floating.$el.offsetHeight;i+l<e&&i>0&&(this.$refs.floating.$el.style.left=i+"px"),o+s<n&&o>0&&(this.$refs.floating.$el.style.top=o+"px")},onEnd:function(a){t.log("onEnd",a)}},mounted:function(){this.init()}};a.default=n}).call(this,e("5a52")["default"])},"8f24":function(t,a,e){"use strict";(function(t){e("7a82"),Object.defineProperty(a,"__esModule",{value:!0}),a.publishedBooksMessage=a.nameInArr=a.meters=void 0;a.publishedBooksMessage=function(a){t.log("时间",a);var e="",n=Math.floor(a/60);return a-=60*n,e=0==a?n?n+"小时":"":(n?n+"小时":"")+(a?a+" 分钟":""),e};a.meters=function(t){if(t<1e3)return t+" 米";var a=0;return a=0===(t/1e3).toFixed(1).split(".")[1]?(t/1e3).toFixed(1).split(".")[0]:(t/1e3).toFixed(1),a+" 千米"};a.nameInArr=function(t){return[t]}}).call(this,e("5a52")["default"])},"966b":function(t,a,e){"use strict";e.d(a,"b",(function(){return i})),e.d(a,"c",(function(){return o})),e.d(a,"a",(function(){return n}));var n={aiRoute:e("dc2f").default},i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",[e("ai-route",{staticClass:"route",attrs:{showModal:t.showModal,myPlanInfo:t.myPlanInfo},on:{changeMapPoi:function(a){arguments[0]=a=t.$handleEvent(a),t.changeMapPoi.apply(void 0,arguments)}}}),e("v-uni-map",{staticClass:"map",attrs:{id:"mapCtx",skew:"30","show-location":!0,latitude:t.latitude,longitude:t.longitude,subkey:"Y4MBZ-WIJWT-3YGXP-VXLPR-RZ76J-RKBBE","layer-style":"2",scale:t.myScale,markers:t.markers,polyline:t.polyline}})],1)},o=[]},"9fc5":function(t,a,e){"use strict";e.r(a);var n=e("7a7d"),i=e.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){e.d(a,t,(function(){return n[t]}))}(o);a["default"]=i.a},a2bf:function(t,a,e){"use strict";var n=e("e8b5"),i=e("07fa"),o=e("3511"),l=e("0366"),s=function(t,a,e,r,u,c,d,f){var p,h,v=u,m=0,g=!!d&&l(d,f);while(m<r)m in e&&(p=g?g(e[m],m,a):e[m],c>0&&n(p)?(h=i(p),v=s(t,a,p,h,v,c-1)-1):(o(v+1),t[v]=p),v++),m++;return v};t.exports=s},af3f:function(t,a,e){"use strict";var n=e("b097"),i=e.n(n);i.a},b088:function(t,a,e){var n=e("24fb");a=n(!1),a.push([t.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.floatingComponent[data-v-1061d0a9]{color:#fff;position:fixed;z-index:11;bottom:%?30?%;left:%?25?%}',""]),t.exports=a},b097:function(t,a,e){var n=e("b088");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=e("4f06").default;i("21396db5",n,!0,{sourceMap:!1,shadowMode:!1})},c747:function(t,a,e){var n=e("7a7b");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=e("4f06").default;i("c1458222",n,!0,{sourceMap:!1,shadowMode:!1})},dc2f:function(t,a,e){"use strict";e.r(a);var n=e("6068"),i=e("6528");for(var o in i)["default"].indexOf(o)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(o);e("fbb5");var l=e("f0c5"),s=Object(l["a"])(i["default"],n["b"],n["c"],!1,null,"80f07a26",null,!1,n["a"],void 0);a["default"]=s.exports},de5a:function(t,a,e){"use strict";e.r(a);var n=e("29e0"),i=e("218b");for(var o in i)["default"].indexOf(o)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(o);e("af3f");var l=e("f0c5"),s=Object(l["a"])(i["default"],n["b"],n["c"],!1,null,"1061d0a9",null,!1,n["a"],void 0);a["default"]=s.exports},fbb5:function(t,a,e){"use strict";var n=e("c747"),i=e.n(n);i.a}}]);